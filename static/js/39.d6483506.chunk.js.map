{"version":3,"sources":["pages/wardrobe/create/index.js"],"names":["Create","dispatch","useDispatch","store","useSelector","state","wardrobes","storeProduct","products","useState","isLoading","setLoading","a","wardrobe","newWardrobe","image_file","formData","FormData","append","uploadImage","image","data","image_url","url","image_url_thumb","thumb_url","back_ground_file","back_ground_url","back_ground_url_thumb","wardrobe_images","length","isUpload","forEach","wardrobe_image","id","file","push","uploadImages","files","name","originalname","image_detail","file_path","file_name","filename","mimetype","collection_file","collection_url","collection_url_thumb","createWardrobe","catch","res","status","history","go","useEffect","getAllProducts","className","allProducts","handleSubmitButton"],"mappings":"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","file":"static/js/39.d6483506.chunk.js","sourcesContent":["// ** React Import\r\nimport React, {useEffect, Fragment, useState} from 'react'\r\n// ** Store & Actions\r\nimport { useDispatch, useSelector } from 'react-redux'\r\n\r\nimport '@styles/base/pages/app-ecommerce-details.scss'\r\nimport CommonFooter from \"../../../components/CommonFooter\"\r\nimport {getAllProducts, uploadImages} from \"../../product/store/action\"\r\nimport {uploadImage} from \"../../instagram/store/action\"\r\nimport {createWardrobe} from \"../store/action\"\r\nimport {Card, CardBody, Col, Row} from \"reactstrap\"\r\nimport WardrobeInformation from \"../layout/components/WardrobeInformation\"\r\nimport WardrobeModelPhoto from \"../layout/components/WardrobeModelPhoto\"\r\nimport WardrobeCollection from \"../layout/components/WardrobeCollection\"\r\n\r\nconst Create = () => {\r\n  // ** Vars\r\n  // ** Store Vars\r\n  const dispatch = useDispatch()\r\n  const store = useSelector(state => state.wardrobes)\r\n  const storeProduct = useSelector(state => state.products)\r\n  const [isLoading, setLoading] = useState(false)\r\n    useEffect(() => {\r\n        dispatch(getAllProducts())\r\n    }, [dispatch])\r\n\r\n    async function handleSubmitButton () {\r\n       if (isLoading) {\r\n           return\r\n       }\r\n        setLoading(true)\r\n        const wardrobe = store.newWardrobe\r\n        if (wardrobe.image_file) {\r\n            const formData = new FormData()\r\n            formData.append(`image`, wardrobe.image_file)\r\n            const image = await uploadImage(formData)\r\n            if (image?.data?.data) {\r\n                wardrobe.image_url = image?.data?.data?.url\r\n                wardrobe.image_url_thumb = image?.data?.data?.thumb_url\r\n                wardrobe.image_file = null\r\n            }\r\n        }\r\n        if (wardrobe.back_ground_file) {\r\n            const formData = new FormData()\r\n            formData.append(`image`, wardrobe.back_ground_file)\r\n            const image = await uploadImage(formData)\r\n            if (image?.data?.data) {\r\n                wardrobe.back_ground_url = image?.data?.data?.url\r\n                wardrobe.back_ground_url_thumb = image?.data?.data?.thumb_url\r\n                wardrobe.back_ground_file = null\r\n            }\r\n        }\r\n\r\n        if (wardrobe?.wardrobe_images?.length > 0) {\r\n            const formData = new FormData()\r\n            let i = 0\r\n            let isUpload = false\r\n            const wardrobe_images = []\r\n            wardrobe?.wardrobe_images.forEach(wardrobe_image => {\r\n                if (typeof wardrobe_image?.id !== 'number') {\r\n                    isUpload = true\r\n                    formData.append(`images`, wardrobe_image.file.data)\r\n                    i++\r\n                } else {\r\n                    wardrobe_images.push(wardrobe_image)\r\n                }\r\n            })\r\n            if (isUpload) {\r\n                const files = await uploadImages(formData)\r\n                wardrobe?.wardrobe_images.forEach(wardrobe_image => {\r\n                    files?.data?.data?.forEach(file => {\r\n                        if (wardrobe_image?.file?.data?.name === file.originalname) {\r\n                            const image_detail = {}\r\n                            image_detail.file_path = file.originalname\r\n                            image_detail.file_name = file.filename\r\n                            image_detail.image_url = file.url\r\n                            image_detail.thumb_url = file.thumb_url\r\n                            image_detail.mimetype = file.mimetype\r\n                            wardrobe_images.push(image_detail)\r\n                        }\r\n                    })\r\n                })\r\n            }\r\n            wardrobe.wardrobe_images = []\r\n            wardrobe_images.forEach(image_detail => {\r\n                wardrobe.wardrobe_images.push(image_detail)\r\n            })\r\n        }\r\n\r\n        if (wardrobe.collection_file) {\r\n            const formData = new FormData()\r\n            formData.append(`image`, wardrobe.collection_file)\r\n            const image = await uploadImage(formData)\r\n            if (image?.data?.data) {\r\n                wardrobe.collection_url = image?.data?.data?.url\r\n                wardrobe.collection_url_thumb = image?.data?.data?.thumb_url\r\n                wardrobe.collection_file = null\r\n            }\r\n        }\r\n        const res = await createWardrobe(wardrobe).catch(\r\n            () => {\r\n                setLoading(false)\r\n            }\r\n        )\r\n\r\n        setLoading(false)\r\n        if (res?.data?.status) {\r\n            store.newWardrobe = {}\r\n            history?.go(-1)\r\n        } else {\r\n            //show error message\r\n        }\r\n    }\r\n\r\n  // ** ComponentDidMount : Get product\r\n  return (\r\n      <Fragment>\r\n          <div className='app-ecommerce-details'>\r\n              {\r\n                  isLoading &&\r\n                  <div className='loading'>\r\n                      <div className='effect-1 effects'/>\r\n                      <div className='effect-2 effects'/>\r\n                      <div className='effect-3 effects'/>\r\n                  </div>\r\n              }\r\n              <Row className='my-2 wardrobe-wrapper'>\r\n                  <WardrobeInformation wardrobe={store.newWardrobe}/>\r\n                  <Col className={`wardrobe col-xl-6 col-sm-12`}>\r\n                      <Card className={'model'}>\r\n                          <CardBody>\r\n                              <h2 className={'wardrobe-title'}>\r\n                                  Thông tin mẫu\r\n                              </h2>\r\n                              <div className={'wardrobe-body'}>\r\n                                  <WardrobeModelPhoto wardrobe={store.newWardrobe}/>\r\n                              </div>\r\n                          </CardBody>\r\n                      </Card>\r\n                  </Col>\r\n              </Row>\r\n              <Row>\r\n                  <WardrobeCollection wardrobe={store.newWardrobe} products={storeProduct.allProducts}/>\r\n              </Row>\r\n              <CommonFooter handleSubmitButton={handleSubmitButton} isLoading={isLoading}/>\r\n          </div>\r\n      </Fragment>\r\n  )\r\n}\r\n\r\nexport default Create\r\n"],"sourceRoot":""}